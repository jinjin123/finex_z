tvApp.create(function(e,t){utils.getSymbol(e.baseUrl+e.api.appSymbol,t)},function(o){var d={httpData:{},widget:null,activeChart:null,getBarTimer:null,get interval(){return o.tradingView.option.interval},get symbol(){return o.tradingView.symbol.symbol},init:function(){d.initWeight()},initData:function(){var e=o.baseUrl+o.api.appCandles;utils.getCandles(e,this.symbol,utils.toSecond(this.interval),function(e){d.httpData[d.ticker]=e,d._socket.subscribe()})},initWeight:function(){this._socket.init(),o.tradingView.option=$.extend(this.option,o.tradingView.option,{datafeed:utils.datafeeds(this._datafeeds)}),this.initData(),this.widget=new TradingView.widget(o.tradingView.option),this.widget.onChartReady(function(){var t=this.activeChart();(d.activeChart=t).createStudy("Moving Average",!1,!1,[5],null,{"plot.color":"#09e"}),t.createStudy("Moving Average",!1,!1,[10],null,{"plot.color":"#dad553"}),t.onIntervalChanged().subscribe(null,function(e){d._socket.unSubscribe(),o.tradingView.option.interval=e,t.setResolution(e),d.initData()})})},get ticker(){return this.symbol+"-"+this.interval},get option(){var e="dark"!=o.tradingView.theme?"light":"dark",t="light"==e?"#ffffff":"#222222",r={};switch(e){case"dark":r={overrides:{"paneProperties.background":"#222222","paneProperties.vertGridProperties.color":t,"paneProperties.horzGridProperties.color":t,"symbolWatermarkProperties.transparency":90,"scalesProperties.textColor":"#AAA"}}}return $.extend({symbol:"BTC-USDT",user_id:"public_user_id",fullscreen:!0,autosize:!0,container_id:"trading-view",datafeed:null,custom_css_url:"../../css/custom.css",disabled_features:["save_chart_properties_to_local_storage","volume_force_overlay","header_saveload","header_symbol_search","header_chart_type","header_compare","header_undo_redo","timeframes_toolbar","countdown","caption_buttons_text_if_possible","use_localstorage_for_settings","compare_symbol"],enabled_features:["hide_last_na_study_output","hide_left_toolbar_by_default"],theme:e,timezone:"Asia/Shanghai",locale:"zh",preset:"mobile",overrides:{"paneProperties.background":t,"paneProperties.vertGridProperties.color":t,"paneProperties.horzGridProperties.color":t,"paneProperties.crossHairProperties.color":"#989898","paneProperties.crossHairProperties.width":1,"mainSeriesProperties.candleStyle.upColor":"#69c0ad","mainSeriesProperties.candleStyle.downColor":"#f25c6f","mainSeriesProperties.candleStyle.borderUpColor":"#69c0ad","mainSeriesProperties.candleStyle.borderDownColor":"#f25c6f","mainSeriesProperties.candleStyle.wickUpColor":"#69c0ad","mainSeriesProperties.candleStyle.wickDownColor":"#f25c6f","mainSeriesProperties.haStyle.upColor":"#69c0ad","mainSeriesProperties.haStyle.downColor":"#f25c6f","mainSeriesProperties.haStyle.borderDownColor":"#f25c6f","mainSeriesProperties.haStyle.borderUpColor":"#69c0ad","mainSeriesProperties.barStyle.upColor":"#69c0ad","mainSeriesProperties.barStyle.downColor":"#f25c6f"},studies_overrides:{"volume.volume.color.0":"#f25c6f","volume.volume.color.1":"#69c0ad"},customFormatters:{timeFormatter:{format:function(e){return moment(e).utc().format("HH:mm")}},dateFormatter:{format:function(e){return moment(e).utc().format("YYYY-MM-DD")}}}},r)},_socket:{self:utils.socket(o.socketUrl,{}),init:function(){this.self.doOpen(),this.self.on("message",this.onMessage)},sendMessage:function(e){var t=this;this.self.checkOpen()?this.self.send(e):this.self.on("open",function(){t.self.send(e)})},unSubscribe:function(){this.sendMessage({op:"unsubscribe",args:this.args})},subscribe:function(){this.sendMessage({op:"subscribe",args:this.args})},onMessage:function(e){if(e.data&&0<e.data.length){var t=e.data[e.data.length-1],r=utils.formatCandles([t.candle],utils.toSecond(d.interval))[0];if("object"==typeof d.httpData[d.ticker]){var i=d.httpData[d.ticker].length;d.httpData[d.ticker][i-1].time==r.time?d.httpData[d.ticker][i-1]=r:d.httpData[d.ticker].push(r)}o.tradingView.option.datafeed.barsUpdater.updateData()}},get args(){return["spot/candle"+utils.toSecond(d.interval)+"s:"+d.symbol]}},_datafeeds:{getConfig:function(){return o.tradingView.config},getSymbol:function(){return o.tradingView.symbol},getBars:function(e,t,r,i,o){var a=d.ticker;if(d.httpData[a]&&d.httpData[a].length){var s=[],n=d.httpData[a];for(var l in n)n[l].time>=1e3*r&&n[l].time<=1e3*i&&s.push(n[l]);o(s)}else{var c=this;d.getBarTimer=setTimeout(function(){c.getBars(e,t,r,i,o)},10)}}}};d.init()});